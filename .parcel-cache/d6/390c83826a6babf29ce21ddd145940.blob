"use strict";

require("sanitize.css/sanitize.css");

require("./main.scss");

var _jquery = _interopRequireDefault(require("jquery"));

var _mailcheck = _interopRequireDefault(require("mailcheck"));

var _validate = _interopRequireDefault(require("validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// import "flexboxgrid/css/flexboxgrid.min.css";
//
//
(0, _jquery.default)(function () {
  const email = document.querySelector("#email");
  const emailMessage = document.querySelector(".input-group-message");
  const emailField = document.querySelector(".form-group--email");
  const btnDownload = document.querySelector(".btn--download"); //

  let domains = ["me.com", "outlook.com", "netvigator.com", "cloud.com", "live.hk", "msn.com", "gmail.com", "hotmail.com", "ymail.com", "yahoo.com", "yahoo.com.tw", "yahoo.com.hk"];
  email.addEventListener("blur", function () {
    emailMessage.innerText = "";

    if (email.value === "") {} else {
      _mailcheck.default.run({
        email: email.value,
        domains: domains,
        // optional
        suggested: function (suggestion) {
          // callback code
          emailMessage.innerHTML = `您要輸入的是 <span class="email-suggestion">${suggestion.full}</span> 嗎？`;
        },
        empty: function () {
          // callback code
          emailMessage.innerHTML = `電郵地址格式錯誤`;
        }
      });
    }
  });
  emailMessage.addEventListener("click", function () {
    const emailSuggestion = document.querySelector(".email-suggestion").innerText;

    if (emailSuggestion) {
      email.value = emailSuggestion.innerText;
      emailMessage.innerHTML = "";
    }
  }); //

  const customFormHandle = function () {
    var constraints = {
      email: {
        // If email is required
        presence: true,
        // and you want to check if this is an email
        email: true,
        message: "電郵地址格式錯誤"
      }
    };
    const customForm = document.querySelector(".form__wrapper form");
    let errors = (0, _validate.default)({
      email: email.value
    }, constraints);
    console.log(errors);

    if (!errors) {
      document.querySelector('input[name="supporter.emailAddress"]').value = email.value;
    }
  };

  btnDownload.addEventListener("click", function (event) {
    event.preventDefault;
    customFormHandle();
  }); //

  const enFormSubmit = function () {
    (0, _jquery.default)(".enform__wrapper form").submit();
  };
});